<h1 id="nodesqskboxrendererellipsecpp">nodes/QskBoxRendererEllipse.cpp</h1>

<h2 id="functions">Functions</h2>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Qt::Orientation</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskqtorientation">qskQtOrientation</a></strong>(const QskGradient &amp; gradient)</td>
    </tr>
    <tr>
      <td>int</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskfilllinecount">qskFillLineCount</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, const QskGradient &amp; gradient)</td>
    </tr>
    <tr>
      <td>template &lt;class Line ,class BorderMap ,class FillMap &gt; <br />void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderlines">qskRenderLines</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, Line * borderLines, const BorderMap &amp; borderMapTL, const BorderMap &amp; borderMapTR, const BorderMap &amp; borderMapBL, const BorderMap &amp; borderMapBR, Line * fillLines, const FillMap &amp; fillMap)</td>
    </tr>
    <tr>
      <td>template &lt;class Line ,class BorderMap ,class FillMap &gt; <br />void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderlines">qskRenderLines</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, Line * borderLines, const BorderMap &amp; borderMap, Line * fillLines, const FillMap &amp; fillMap)</td>
    </tr>
    <tr>
      <td>template &lt;class Line ,class BorderMap &gt; <br />void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderborderlines">qskRenderBorderLines</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, Line * lines, const BorderMap &amp; borderMapTL, const BorderMap &amp; borderMapTR, const BorderMap &amp; borderMapBL, const BorderMap &amp; borderMapBR)</td>
    </tr>
    <tr>
      <td>template &lt;class Line ,class BorderMap &gt; <br />void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderborderlines">qskRenderBorderLines</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, Line * lines, const BorderMap &amp; borderMap)</td>
    </tr>
    <tr>
      <td>template &lt;class Line ,class FillMap &gt; <br />void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderfilllines">qskRenderFillLines</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, Line * lines, const FillMap &amp; fillMap)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderborder">qskRenderBorder</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, Qt::Orientation orientation, const QskBoxBorderColors &amp; colors, ColoredLine * line)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderfillrandom">qskRenderFillRandom</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, const QskGradient &amp; gradient, ColoredLine * line)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderboxrandom">qskRenderBoxRandom</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, const QskBoxBorderColors &amp; borderColors, const QskGradient &amp; gradient, ColoredLine * fillLine, ColoredLine * borderLine)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskBoxRendererEllipse_8cpp/#function-qskrenderfillordered">qskRenderFillOrdered</a></strong>(const QskBoxRenderer::Metrics &amp; metrics, const QskGradient &amp; gradient, ColoredLine * lines)</td>
    </tr>
  </tbody>
</table>

<h2 id="functions-documentation">Functions Documentation</h2>

<h3 id="function-qskqtorientation">function qskQtOrientation</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">qskQtOrientation</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskGradient</span> <span class="o">&amp;</span> <span class="n">gradient</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskfilllinecount">function qskFillLineCount</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="n">qskFillLineCount</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span> <span class="o">&amp;</span> <span class="n">gradient</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderlines">function qskRenderLines</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Line</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">borderLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapTL</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapTR</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapBL</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapBR</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">fillLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">FillMap</span> <span class="o">&amp;</span> <span class="n">fillMap</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderlines-1">function qskRenderLines</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Line</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">borderLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMap</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">fillLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">FillMap</span> <span class="o">&amp;</span> <span class="n">fillMap</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderborderlines">function qskRenderBorderLines</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Line</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderBorderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">lines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapTL</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapTR</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapBL</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMapBR</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderborderlines-1">function qskRenderBorderLines</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Line</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderBorderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">lines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span> <span class="o">&amp;</span> <span class="n">borderMap</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderfilllines">function qskRenderFillLines</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Line</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderFillLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span> <span class="o">*</span> <span class="n">lines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">FillMap</span> <span class="o">&amp;</span> <span class="n">fillMap</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderborder">function qskRenderBorder</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderBorder</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxBorderColors</span> <span class="o">&amp;</span> <span class="n">colors</span><span class="p">,</span>
    <span class="n">ColoredLine</span> <span class="o">*</span> <span class="n">line</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderfillrandom">function qskRenderFillRandom</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderFillRandom</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span> <span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span>
    <span class="n">ColoredLine</span> <span class="o">*</span> <span class="n">line</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderboxrandom">function qskRenderBoxRandom</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderBoxRandom</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxBorderColors</span> <span class="o">&amp;</span> <span class="n">borderColors</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span> <span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span>
    <span class="n">ColoredLine</span> <span class="o">*</span> <span class="n">fillLine</span><span class="p">,</span>
    <span class="n">ColoredLine</span> <span class="o">*</span> <span class="n">borderLine</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskrenderfillordered">function qskRenderFillOrdered</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskRenderFillOrdered</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span> <span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span> <span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span>
    <span class="n">ColoredLine</span> <span class="o">*</span> <span class="n">lines</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="source-code">Source code</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/******************************************************************************
 * QSkinny - Copyright (C) 2016 Uwe Rathmann
 * This file may be used under the terms of the QSkinny License, Version 1.0
 *****************************************************************************/</span>

<span class="cp">#include "QskBoxRenderer.h"
#include "QskGradient.h"
</span>
<span class="cp">#include "QskBoxBorderColors.h"
#include "QskBoxBorderMetrics.h"
#include "QskBoxRendererColorMap.h"
#include "QskBoxShapeMetrics.h"
</span>
<span class="cp">#include &lt;qmath.h&gt;
#include &lt;qsggeometry.h&gt;
</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">QskVertex</span><span class="p">;</span>

<span class="k">namespace</span>
<span class="p">{</span>
    <span class="k">enum</span>
    <span class="p">{</span>
        <span class="n">TopLeft</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">TopLeftCorner</span><span class="p">,</span>
        <span class="n">TopRight</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">TopRightCorner</span><span class="p">,</span>
        <span class="n">BottomLeft</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">BottomLeftCorner</span><span class="p">,</span>
        <span class="n">BottomRight</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">::</span><span class="n">BottomRightCorner</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">ArcIterator</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">ArcIterator</span><span class="p">()</span> <span class="o">=</span> <span class="k">default</span><span class="p">;</span>

        <span class="kr">inline</span> <span class="n">ArcIterator</span><span class="p">(</span> <span class="kt">int</span> <span class="n">stepCount</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">inverted</span> <span class="o">=</span> <span class="nb">false</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">reset</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">inverted</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="kt">void</span> <span class="n">reset</span><span class="p">(</span> <span class="kt">int</span> <span class="n">stepCount</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">inverted</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">m_inverted</span> <span class="o">=</span> <span class="n">inverted</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">inverted</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">m_cos</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
                <span class="n">m_sin</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">m_cos</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="n">m_sin</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">m_stepIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="n">m_stepCount</span> <span class="o">=</span> <span class="n">stepCount</span><span class="p">;</span>

            <span class="k">const</span> <span class="kt">double</span> <span class="n">angleStep</span> <span class="o">=</span> <span class="n">M_PI_2</span> <span class="o">/</span> <span class="n">stepCount</span><span class="p">;</span>
            <span class="n">m_cosStep</span> <span class="o">=</span> <span class="n">qFastCos</span><span class="p">(</span> <span class="n">angleStep</span> <span class="p">);</span>
            <span class="n">m_sinStep</span> <span class="o">=</span> <span class="n">qFastSin</span><span class="p">(</span> <span class="n">angleStep</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">isInverted</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inverted</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">double</span> <span class="n">cos</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_cos</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="kt">double</span> <span class="n">sin</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inverted</span> <span class="o">?</span> <span class="o">-</span><span class="n">m_sin</span> <span class="o">:</span> <span class="n">m_sin</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">int</span> <span class="n">step</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_stepIndex</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="kt">int</span> <span class="n">stepCount</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_stepCount</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">isDone</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_stepIndex</span> <span class="o">&gt;</span> <span class="n">m_stepCount</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">increment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="kt">double</span> <span class="n">cos0</span> <span class="o">=</span> <span class="n">m_cos</span><span class="p">;</span>

            <span class="n">m_cos</span> <span class="o">=</span> <span class="n">m_cos</span> <span class="o">*</span> <span class="n">m_cosStep</span> <span class="o">+</span> <span class="n">m_sin</span> <span class="o">*</span> <span class="n">m_sinStep</span><span class="p">;</span>
            <span class="n">m_sin</span> <span class="o">=</span> <span class="n">m_sin</span> <span class="o">*</span> <span class="n">m_cosStep</span> <span class="o">-</span> <span class="n">cos0</span> <span class="o">*</span> <span class="n">m_sinStep</span><span class="p">;</span>

            <span class="o">++</span><span class="n">m_stepIndex</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="k">operator</span><span class="o">++</span><span class="p">()</span> <span class="p">{</span> <span class="n">increment</span><span class="p">();</span> <span class="p">}</span>

        <span class="k">static</span> <span class="kt">int</span> <span class="n">segmentHint</span><span class="p">(</span> <span class="kt">double</span> <span class="n">radius</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="kt">double</span> <span class="n">arcLength</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">M_PI_2</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">qBound</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">qCeil</span><span class="p">(</span> <span class="n">arcLength</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="p">),</span> <span class="mi">18</span> <span class="p">);</span> <span class="c1">// every 3 pixels</span>
        <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="kt">double</span> <span class="n">m_cos</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">m_sin</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">m_stepIndex</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">m_cosStep</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">m_sinStep</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">m_stepCount</span><span class="p">;</span>
        <span class="kt">bool</span> <span class="n">m_inverted</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">namespace</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">BorderValuesUniform</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">BorderValuesUniform</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_corner</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_dx1</span><span class="p">(</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_dy1</span><span class="p">(</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setAngle</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">cos</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">sin</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">m_corner</span><span class="p">.</span><span class="n">isCropped</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">m_dx1</span> <span class="o">=</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusInnerX</span><span class="p">;</span>
                <span class="n">m_dy1</span> <span class="o">=</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusInnerY</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">m_dx2</span> <span class="o">=</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
            <span class="n">m_dy2</span> <span class="o">=</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">m_corner</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dx1</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_dx1</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dy1</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_dy1</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dx2</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_dx2</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dy2</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_dy2</span><span class="p">;</span> <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">::</span><span class="n">Corner</span><span class="o">&amp;</span> <span class="n">m_corner</span><span class="p">;</span>
        <span class="n">qreal</span> <span class="n">m_dx1</span><span class="p">,</span> <span class="n">m_dy1</span><span class="p">,</span> <span class="n">m_dx2</span><span class="p">,</span> <span class="n">m_dy2</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">BorderValues</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">BorderValues</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_uniform</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isRadiusRegular</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>
                <span class="k">auto</span><span class="o">&amp;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">x0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">rx</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">y0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">ry</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">y0</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">ry</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">m_outer</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">x0</span> <span class="o">=</span> <span class="n">m_outer</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">y0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="n">m_outer</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">rx</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
                <span class="n">m_outer</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">ry</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setAngle</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">cos</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">sin</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">2</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">3</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>

            <span class="n">m_outer</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">m_uniform</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">m_outer</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
                <span class="n">m_outer</span><span class="p">[</span> <span class="mi">2</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
                <span class="n">m_outer</span><span class="p">[</span> <span class="mi">3</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dx1</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">pos</span><span class="p">].</span><span class="n">dx</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dy1</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">pos</span> <span class="p">].</span><span class="n">dy</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dx2</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span>
            <span class="p">{</span> <span class="k">return</span> <span class="n">m_uniform</span> <span class="o">?</span> <span class="n">m_outer</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">dx</span> <span class="o">:</span> <span class="n">m_outer</span><span class="p">[</span> <span class="n">pos</span> <span class="p">].</span><span class="n">dx</span><span class="p">;</span> <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dy2</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span>
            <span class="p">{</span> <span class="k">return</span> <span class="n">m_uniform</span> <span class="o">?</span> <span class="n">m_outer</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">dy</span> <span class="o">:</span> <span class="n">m_outer</span><span class="p">[</span> <span class="n">pos</span> <span class="p">].</span><span class="n">dy</span><span class="p">;</span> <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="kt">bool</span> <span class="n">m_uniform</span><span class="p">;</span>
        <span class="k">class</span> <span class="nc">Values</span>
        <span class="p">{</span>
          <span class="nl">public:</span>
            <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setAngle</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">cos</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">sin</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">rx</span><span class="p">;</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">ry</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">qreal</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">;</span>
            <span class="n">qreal</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">;</span>
        <span class="p">};</span>

        <span class="n">Values</span> <span class="n">m_inner</span><span class="p">[</span> <span class="mi">4</span> <span class="p">];</span>
        <span class="n">Values</span> <span class="n">m_outer</span><span class="p">[</span> <span class="mi">4</span> <span class="p">];</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">FillValues</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">FillValues</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>
                <span class="k">auto</span><span class="o">&amp;</span> <span class="n">v</span> <span class="o">=</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">x0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">rx</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">&gt;=</span> <span class="mf">0.0</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">y0</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">ry</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">y0</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span><span class="p">;</span>
                    <span class="n">v</span><span class="p">.</span><span class="n">ry</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setAngle</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">cos</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">sin</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">2</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
            <span class="n">m_inner</span><span class="p">[</span> <span class="mi">3</span> <span class="p">].</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dx</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">pos</span> <span class="p">].</span><span class="n">dx</span><span class="p">;</span> <span class="p">}</span>
        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">dy</span><span class="p">(</span> <span class="kt">int</span> <span class="n">pos</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_inner</span><span class="p">[</span> <span class="n">pos</span> <span class="p">].</span><span class="n">dy</span><span class="p">;</span> <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">class</span> <span class="nc">Values</span>
        <span class="p">{</span>
          <span class="nl">public:</span>
            <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setAngle</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">cos</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">sin</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">cos</span> <span class="o">*</span> <span class="n">rx</span><span class="p">;</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">sin</span> <span class="o">*</span> <span class="n">ry</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">qreal</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">;</span>
            <span class="n">qreal</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">;</span>
        <span class="p">};</span>

        <span class="n">Values</span> <span class="n">m_inner</span><span class="p">[</span> <span class="mi">4</span> <span class="p">];</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">namespace</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">VRectEllipseIterator</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="n">VRectEllipseIterator</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_metrics</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_values</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">;</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">left</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerX</span><span class="p">;</span>
            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">right</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerX</span><span class="p">;</span>
            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">;</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>

            <span class="n">m_leadingCorner</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">stepCount</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span>
                <span class="o">?</span> <span class="n">TopLeft</span> <span class="o">:</span> <span class="n">TopRight</span><span class="p">;</span>

            <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">ColorIterator</span> <span class="p">&gt;</span>
        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setGradientLine</span><span class="p">(</span> <span class="k">const</span> <span class="n">ColorIterator</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">y</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">value</span><span class="p">();</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span> <span class="n">y</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">y</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">y</span> <span class="p">);</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">left</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">left</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">left</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">left</span> <span class="p">);</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">right</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">right</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">right</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">right</span> <span class="p">);</span>

            <span class="n">line</span><span class="o">-&gt;</span><span class="n">setLine</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">color</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">ColorIterator</span> <span class="p">&gt;</span>
        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setContourLine</span><span class="p">(</span> <span class="k">const</span> <span class="n">ColorIterator</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">line</span><span class="o">-&gt;</span><span class="n">setLine</span><span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">left</span><span class="p">,</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span><span class="p">,</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">right</span><span class="p">,</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">value</span><span class="p">()</span> <span class="k">const</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">advance</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">centerQuad</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">;</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">step</span><span class="p">()</span> <span class="o">==</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">stepCount</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">isInverted</span><span class="p">()</span> <span class="p">)</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

                <span class="n">m_leadingCorner</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">stepCount</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span>
                    <span class="o">?</span> <span class="n">BottomLeft</span> <span class="o">:</span> <span class="n">BottomRight</span><span class="p">;</span>

                <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&lt;</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">];</span>

                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">left</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">;</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">right</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span><span class="p">;</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span><span class="p">;</span>

                    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">increment</span><span class="p">();</span>
            <span class="n">m_values</span><span class="p">.</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">cos</span><span class="p">(),</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">sin</span><span class="p">()</span> <span class="p">);</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">isInverted</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">left</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">BottomLeft</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">right</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">BottomRight</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">m_leadingCorner</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">left</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">right</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">TopRight</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">y</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">m_leadingCorner</span> <span class="p">);</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">m_metrics</span><span class="p">;</span>
        <span class="n">ArcIterator</span> <span class="n">m_arcIterator</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">m_leadingCorner</span><span class="p">;</span>
        <span class="n">FillValues</span> <span class="n">m_values</span><span class="p">;</span>
        <span class="k">struct</span> <span class="p">{</span> <span class="n">qreal</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">y</span><span class="p">;</span> <span class="p">}</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">2</span> <span class="p">];</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">HRectEllipseIterator</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="n">HRectEllipseIterator</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_metrics</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_values</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">;</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">top</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerY</span><span class="p">;</span>
            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerY</span><span class="p">;</span>
            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">;</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>

            <span class="n">m_leadingCorner</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">stepCount</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span>
                <span class="o">?</span> <span class="n">TopLeft</span> <span class="o">:</span> <span class="n">BottomLeft</span><span class="p">;</span>

            <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span> <span class="nb">true</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">ColorIterator</span> <span class="p">&gt;</span>
        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setGradientLine</span><span class="p">(</span> <span class="k">const</span> <span class="n">ColorIterator</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">x</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">value</span><span class="p">();</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span> <span class="n">x</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">x</span> <span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">x</span> <span class="p">);</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">top</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">top</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">top</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">top</span> <span class="p">);</span>
            <span class="k">const</span> <span class="n">qreal</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">+</span> <span class="n">f</span> <span class="o">*</span> <span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">bottom</span> <span class="p">);</span>

            <span class="n">line</span><span class="o">-&gt;</span><span class="n">setLine</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">color</span><span class="p">()</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">ColorIterator</span> <span class="p">&gt;</span>
        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">setContourLine</span><span class="p">(</span> <span class="k">const</span> <span class="n">ColorIterator</span><span class="o">&amp;</span> <span class="n">it</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">line</span><span class="o">-&gt;</span><span class="n">setLine</span><span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">top</span><span class="p">,</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span><span class="p">,</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">bottom</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span> <span class="p">)</span> <span class="p">);</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">qreal</span> <span class="n">value</span><span class="p">()</span> <span class="k">const</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">advance</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">centerQuad</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">;</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">step</span><span class="p">()</span> <span class="o">==</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">stepCount</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">m_arcIterator</span><span class="p">.</span><span class="n">isInverted</span><span class="p">()</span> <span class="p">)</span>
                    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

                <span class="n">m_leadingCorner</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="o">&gt;=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span>
                    <span class="o">?</span> <span class="n">TopRight</span> <span class="o">:</span> <span class="n">BottomRight</span><span class="p">;</span>

                <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">reset</span><span class="p">(</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">&lt;</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">];</span>

                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">top</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">;</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span><span class="p">;</span>
                    <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span><span class="p">;</span>

                    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">increment</span><span class="p">();</span>
            <span class="n">m_values</span><span class="p">.</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">cos</span><span class="p">(),</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">sin</span><span class="p">()</span> <span class="p">);</span>

            <span class="n">m_v</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">];</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">m_arcIterator</span><span class="p">.</span><span class="n">isInverted</span><span class="p">()</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">top</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">BottomLeft</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">m_leadingCorner</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">top</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">TopRight</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dy</span><span class="p">(</span> <span class="n">BottomRight</span> <span class="p">);</span>
                <span class="n">m_v</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">x</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">m_leadingCorner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">m_values</span><span class="p">.</span><span class="n">dx</span><span class="p">(</span> <span class="n">m_leadingCorner</span> <span class="p">);</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">m_metrics</span><span class="p">;</span>
        <span class="n">ArcIterator</span> <span class="n">m_arcIterator</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">m_leadingCorner</span><span class="p">;</span>
        <span class="n">FillValues</span> <span class="n">m_values</span><span class="p">;</span>
        <span class="k">struct</span> <span class="p">{</span> <span class="n">qreal</span> <span class="n">top</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">x</span><span class="p">;</span> <span class="p">}</span> <span class="n">m_v</span><span class="p">[</span> <span class="mi">2</span> <span class="p">];</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">namespace</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">BorderMapNone</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="k">static</span> <span class="kr">inline</span> <span class="k">constexpr</span> <span class="n">Color</span> <span class="n">colorAt</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">Color</span><span class="p">();</span> <span class="p">}</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">BorderMapSolid</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">BorderMapSolid</span><span class="p">(</span> <span class="n">QRgb</span> <span class="n">rgb</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_color</span><span class="p">(</span> <span class="n">rgb</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">Color</span> <span class="n">colorAt</span><span class="p">(</span> <span class="kt">int</span> <span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_color</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">const</span> <span class="n">Color</span> <span class="n">m_color</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">class</span> <span class="nc">BorderMapGradient</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">BorderMapGradient</span><span class="p">(</span> <span class="kt">int</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">QRgb</span> <span class="n">rgb1</span><span class="p">,</span> <span class="n">QRgb</span> <span class="n">rgb2</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_stepCount</span><span class="p">(</span> <span class="n">stepCount</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_color1</span><span class="p">(</span> <span class="n">rgb1</span> <span class="p">)</span>
            <span class="p">,</span> <span class="n">m_color2</span><span class="p">(</span> <span class="n">rgb2</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="kr">inline</span> <span class="n">Color</span> <span class="n">colorAt</span><span class="p">(</span> <span class="kt">int</span> <span class="n">step</span> <span class="p">)</span> <span class="k">const</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">m_color1</span><span class="p">.</span><span class="n">interpolatedTo</span><span class="p">(</span> <span class="n">m_color2</span><span class="p">,</span> <span class="n">step</span> <span class="o">/</span> <span class="n">m_stepCount</span> <span class="p">);</span>
        <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">const</span> <span class="n">qreal</span> <span class="n">m_stepCount</span><span class="p">;</span>
        <span class="k">const</span> <span class="n">Color</span> <span class="n">m_color1</span><span class="p">,</span> <span class="n">m_color2</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">BorderValues</span> <span class="p">&gt;</span>
    <span class="k">class</span> <span class="nc">Stroker</span>
    <span class="p">{</span>
      <span class="nl">public:</span>
        <span class="kr">inline</span> <span class="n">Stroker</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span> <span class="p">)</span>
            <span class="o">:</span> <span class="n">m_metrics</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">BorderMap</span><span class="p">,</span> <span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
        <span class="kr">inline</span> <span class="kt">void</span> <span class="n">createLines</span><span class="p">(</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">borderLines</span><span class="p">,</span>
            <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTR</span><span class="p">,</span>
            <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBR</span><span class="p">,</span>
            <span class="n">Line</span><span class="o">*</span> <span class="n">fillLines</span><span class="p">,</span> <span class="n">FillMap</span><span class="o">&amp;</span> <span class="n">fillMap</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">;</span>
<span class="cp">#if 1
</span>            <span class="c1">// TODO ...</span>
            <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>
<span class="cp">#endif
</span>
            <span class="n">Line</span><span class="o">*</span> <span class="n">linesBR</span><span class="p">,</span> <span class="o">*</span> <span class="n">linesTR</span><span class="p">,</span> <span class="o">*</span> <span class="n">linesTL</span><span class="p">,</span> <span class="o">*</span> <span class="n">linesBL</span><span class="p">;</span>
            <span class="n">linesBR</span> <span class="o">=</span> <span class="n">linesTR</span> <span class="o">=</span> <span class="n">linesTL</span> <span class="o">=</span> <span class="n">linesBL</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>

            <span class="k">const</span> <span class="kt">int</span> <span class="n">numCornerLines</span> <span class="o">=</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">numFillLines</span> <span class="o">=</span> <span class="n">fillLines</span> <span class="o">?</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">numCornerLines</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">borderLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">linesBR</span> <span class="o">=</span> <span class="n">borderLines</span><span class="p">;</span>
                    <span class="n">linesTR</span> <span class="o">=</span> <span class="n">linesBR</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                    <span class="n">linesTL</span> <span class="o">=</span> <span class="n">linesTR</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                    <span class="n">linesBL</span> <span class="o">=</span> <span class="n">linesTL</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">fillLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&gt;=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
                        <span class="n">numFillLines</span><span class="o">--</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">borderLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">linesTR</span> <span class="o">=</span> <span class="n">borderLines</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="n">linesTL</span> <span class="o">=</span> <span class="n">linesTR</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                    <span class="n">linesBL</span> <span class="o">=</span> <span class="n">linesTL</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                    <span class="n">linesBR</span> <span class="o">=</span> <span class="n">linesBL</span> <span class="o">+</span> <span class="n">numCornerLines</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">fillLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span>
                        <span class="n">numFillLines</span><span class="o">--</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">BorderValues</span> <span class="n">v</span><span class="p">(</span> <span class="n">m_metrics</span> <span class="p">);</span>

            <span class="cm">/*
                It would be possible to run over [0, 0.5 * M_PI_2]
                and create 8 values ( instead of 4 ) in each step. TODO ...
             */</span>
            <span class="k">for</span> <span class="p">(</span> <span class="n">ArcIterator</span> <span class="n">it</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="nb">false</span> <span class="p">);</span> <span class="o">!</span><span class="n">it</span><span class="p">.</span><span class="n">isDone</span><span class="p">();</span> <span class="o">++</span><span class="n">it</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">v</span><span class="p">.</span><span class="n">setAngle</span><span class="p">(</span> <span class="n">it</span><span class="p">.</span><span class="n">cos</span><span class="p">(),</span> <span class="n">it</span><span class="p">.</span><span class="n">sin</span><span class="p">()</span> <span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">borderLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">const</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">();</span>
                    <span class="k">const</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">numCornerLines</span> <span class="o">-</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

                    <span class="p">{</span>
                        <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">corner</span> <span class="o">=</span> <span class="n">TopLeft</span><span class="p">;</span>

                        <span class="n">linesTL</span><span class="p">[</span> <span class="n">j</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">borderMapTL</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">j</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="p">}</span>

                    <span class="p">{</span>
                        <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">corner</span> <span class="o">=</span> <span class="n">TopRight</span><span class="p">;</span>

                        <span class="n">linesTR</span><span class="p">[</span> <span class="n">k</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">borderMapTR</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">k</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="p">}</span>

                    <span class="p">{</span>
                        <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">corner</span> <span class="o">=</span> <span class="n">BottomLeft</span><span class="p">;</span>

                        <span class="n">linesBL</span><span class="p">[</span> <span class="n">k</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">borderMapBL</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">k</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="p">}</span>

                    <span class="p">{</span>
                        <span class="k">constexpr</span> <span class="k">auto</span> <span class="n">corner</span> <span class="o">=</span> <span class="n">BottomRight</span><span class="p">;</span>

                        <span class="n">linesBR</span><span class="p">[</span> <span class="n">j</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">c</span><span class="p">[</span> <span class="n">corner</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy2</span><span class="p">(</span> <span class="n">corner</span> <span class="p">),</span>
                            <span class="n">borderMapBR</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="n">j</span> <span class="p">)</span> <span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">fillLines</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">ri</span> <span class="o">=</span> <span class="n">m_metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">;</span>

                    <span class="k">if</span> <span class="p">(</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span> <span class="p">)</span>
                    <span class="p">{</span>
                        <span class="k">const</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">();</span>
                        <span class="k">const</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">numFillLines</span> <span class="o">-</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x11</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x12</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">TopRight</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="k">auto</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">fillMap</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="p">(</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">ri</span><span class="p">.</span><span class="n">top</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ri</span><span class="p">.</span><span class="n">height</span> <span class="p">);</span>

                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x21</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">BottomLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x22</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">BottomRight</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">BottomLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="k">auto</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">fillMap</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="p">(</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">ri</span><span class="p">.</span><span class="n">top</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ri</span><span class="p">.</span><span class="n">height</span> <span class="p">);</span>

                        <span class="n">fillLines</span><span class="p">[</span> <span class="n">j</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span> <span class="n">x11</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x12</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">c1</span> <span class="p">);</span>
                        <span class="n">fillLines</span><span class="p">[</span> <span class="n">k</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span> <span class="n">x21</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x22</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">c2</span> <span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">else</span>
                    <span class="p">{</span>
                        <span class="k">const</span> <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">stepCount</span> <span class="o">-</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">();</span>
                        <span class="k">const</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">numFillLines</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="n">it</span><span class="p">.</span><span class="n">step</span><span class="p">();</span>

                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y11</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">TopLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y12</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">BottomLeft</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="k">auto</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">fillMap</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="p">(</span> <span class="n">x1</span> <span class="o">-</span> <span class="n">ri</span><span class="p">.</span><span class="n">left</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ri</span><span class="p">.</span><span class="n">width</span> <span class="p">);</span>

                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dx1</span><span class="p">(</span> <span class="n">TopRight</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y21</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">-</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">TopRight</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="n">qreal</span> <span class="n">y22</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="n">dy1</span><span class="p">(</span> <span class="n">BottomRight</span> <span class="p">);</span>
                        <span class="k">const</span> <span class="k">auto</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">fillMap</span><span class="p">.</span><span class="n">colorAt</span><span class="p">(</span> <span class="p">(</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">ri</span><span class="p">.</span><span class="n">left</span> <span class="p">)</span> <span class="o">/</span> <span class="n">ri</span><span class="p">.</span><span class="n">width</span> <span class="p">);</span>

                        <span class="n">fillLines</span><span class="p">[</span> <span class="n">j</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y11</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y12</span><span class="p">,</span> <span class="n">c1</span> <span class="p">);</span>
                        <span class="n">fillLines</span><span class="p">[</span> <span class="n">k</span> <span class="p">].</span><span class="n">setLine</span><span class="p">(</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y21</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y22</span><span class="p">,</span> <span class="n">c2</span> <span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>

<span class="cp">#if 1
</span>            <span class="k">if</span> <span class="p">(</span> <span class="n">borderLines</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">const</span> <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">numCornerLines</span><span class="p">;</span>

                <span class="k">if</span> <span class="p">(</span> <span class="n">orientation</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span> <span class="p">)</span>
                    <span class="n">borderLines</span><span class="p">[</span> <span class="n">k</span> <span class="p">]</span> <span class="o">=</span> <span class="n">borderLines</span><span class="p">[</span> <span class="mi">0</span> <span class="p">];</span>
                <span class="k">else</span>
                    <span class="n">borderLines</span><span class="p">[</span> <span class="mi">0</span> <span class="p">]</span> <span class="o">=</span> <span class="n">borderLines</span><span class="p">[</span> <span class="n">k</span> <span class="p">];</span>
            <span class="p">}</span>
<span class="cp">#endif
</span>        <span class="p">}</span>

      <span class="nl">private:</span>
        <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">m_metrics</span><span class="p">;</span>
    <span class="p">};</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="nf">qskQtOrientation</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Vertical</span> <span class="p">)</span> <span class="o">?</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span> <span class="o">:</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Horizontal</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">qskFillLineCount</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">gradient</span><span class="p">.</span><span class="n">isVisible</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">lineCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">switch</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="n">lineCount</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span>
                <span class="n">lineCount</span><span class="o">--</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&gt;=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
                <span class="n">lineCount</span><span class="o">--</span><span class="p">;</span>

            <span class="cm">/*
                For diagonal lines the points at the opposite
                side are no points interpolating the outline.
                So we need to insert interpolating lines on both sides
             */</span>

            <span class="n">lineCount</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// a real ellipse could be done with lineCount lines: TODO ...</span>

<span class="cp">#if 1
</span>            <span class="cm">/*
                The termination of the fill algorithm is a bit random
                and might result in having an additional line.
                Until this effect is completely understood, we better
                reserve memory for this to avoid crashes.
             */</span>

            <span class="n">lineCount</span><span class="o">++</span><span class="p">;</span> <span class="c1">// happens in a corner case - needs to be understood: TODO</span>
<span class="cp">#endif
</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Vertical</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="n">lineCount</span> <span class="o">+=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span>
                <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="n">lineCount</span> <span class="o">+=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span>
                <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&gt;=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
                <span class="n">lineCount</span><span class="o">--</span><span class="p">;</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">case</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Horizontal</span><span class="p">:</span>
        <span class="p">{</span>
            <span class="n">lineCount</span> <span class="o">+=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span>
                <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="n">lineCount</span> <span class="o">+=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">,</span>
                <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">stepCount</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span>
                <span class="n">lineCount</span><span class="o">--</span><span class="p">;</span>

            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// adding vertexes for the stops - beside the first/last</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
        <span class="n">lineCount</span> <span class="o">+=</span> <span class="n">gradient</span><span class="p">.</span><span class="n">stops</span><span class="p">().</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>

    <span class="k">return</span> <span class="n">lineCount</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">BorderMap</span><span class="p">,</span> <span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">borderLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTR</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBR</span><span class="p">,</span>
    <span class="n">Line</span><span class="o">*</span> <span class="n">fillLines</span><span class="p">,</span> <span class="k">const</span> <span class="n">FillMap</span><span class="o">&amp;</span> <span class="n">fillMap</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isBorderRegular</span> <span class="o">&amp;&amp;</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isRadiusRegular</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// the same border width for all edges</span>

        <span class="n">Stroker</span><span class="o">&lt;</span> <span class="n">Line</span><span class="p">,</span> <span class="n">BorderValuesUniform</span> <span class="o">&gt;</span> <span class="n">stroker</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">);</span>
        <span class="n">stroker</span><span class="p">.</span><span class="n">createLines</span><span class="p">(</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderLines</span><span class="p">,</span>
            <span class="n">borderMapTL</span><span class="p">,</span> <span class="n">borderMapTR</span><span class="p">,</span> <span class="n">borderMapBL</span><span class="p">,</span> <span class="n">borderMapBR</span><span class="p">,</span>
            <span class="n">fillLines</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">Stroker</span><span class="o">&lt;</span> <span class="n">Line</span><span class="p">,</span> <span class="n">BorderValues</span> <span class="o">&gt;</span> <span class="n">stroker</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">);</span>
        <span class="n">stroker</span><span class="p">.</span><span class="n">createLines</span><span class="p">(</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderLines</span><span class="p">,</span>
            <span class="n">borderMapTL</span><span class="p">,</span> <span class="n">borderMapTR</span><span class="p">,</span> <span class="n">borderMapBL</span><span class="p">,</span> <span class="n">borderMapBR</span><span class="p">,</span>
            <span class="n">fillLines</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">BorderMap</span><span class="p">,</span> <span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span>
    <span class="n">Line</span><span class="o">*</span> <span class="n">borderLines</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">fillLines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">FillMap</span><span class="o">&amp;</span> <span class="n">fillMap</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderLines</span><span class="p">,</span>
        <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">fillLines</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderBorderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">lines</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapTR</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBL</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMapBR</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">borderMapTL</span><span class="p">,</span> <span class="n">borderMapTR</span><span class="p">,</span>
        <span class="n">borderMapBL</span><span class="p">,</span> <span class="n">borderMapBR</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Line</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="nb">nullptr</span> <span class="p">),</span> <span class="n">ColorMapNone</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">BorderMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderBorderLines</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">lines</span><span class="p">,</span> <span class="k">const</span> <span class="n">BorderMap</span><span class="o">&amp;</span> <span class="n">borderMap</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qskRenderBorderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span>
        <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">borderMap</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Line</span><span class="p">,</span> <span class="k">class</span> <span class="nc">FillMap</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderFillLines</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">Line</span><span class="o">*</span> <span class="n">lines</span><span class="p">,</span> <span class="k">const</span> <span class="n">FillMap</span><span class="o">&amp;</span> <span class="n">fillMap</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span>
        <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Line</span><span class="o">*</span> <span class="o">&gt;</span><span class="p">(</span> <span class="nb">nullptr</span> <span class="p">),</span> <span class="n">BorderMapNone</span><span class="p">(),</span> <span class="n">lines</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderBorder</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Orientation</span> <span class="n">orientation</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxBorderColors</span><span class="o">&amp;</span> <span class="n">colors</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">colors</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">colors</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qskRenderBorderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">BorderMapSolid</span><span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>

        <span class="n">qskRenderBorderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span>
            <span class="n">BorderMapGradient</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Top</span> <span class="p">),</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">)</span> <span class="p">),</span>
            <span class="n">BorderMapGradient</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Right</span> <span class="p">),</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Top</span> <span class="p">)</span> <span class="p">),</span>
            <span class="n">BorderMapGradient</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">),</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Bottom</span> <span class="p">)</span> <span class="p">),</span>
            <span class="n">BorderMapGradient</span><span class="p">(</span> <span class="n">stepCount</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Bottom</span> <span class="p">),</span> <span class="n">c</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Right</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderFillRandom</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">line</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">orientation</span> <span class="o">=</span> <span class="n">qskQtOrientation</span><span class="p">(</span> <span class="n">gradient</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">ColorMapSolid</span> <span class="n">map</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">()</span> <span class="p">);</span>
        <span class="n">qskRenderFillLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">map</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">ColorMapGradient</span> <span class="n">map</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">(),</span> <span class="n">gradient</span><span class="p">.</span><span class="n">endColor</span><span class="p">()</span> <span class="p">);</span>
        <span class="n">qskRenderFillLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">map</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderBoxRandom</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxBorderColors</span><span class="o">&amp;</span> <span class="n">borderColors</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">fillLine</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">borderLine</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">bc</span> <span class="o">=</span> <span class="n">borderColors</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">bc</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">BorderMapSolid</span> <span class="n">borderMap</span><span class="p">(</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">)</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="n">ColorMapSolid</span> <span class="n">fillMap</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">()</span> <span class="p">);</span>
            <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span><span class="p">,</span> <span class="n">borderLine</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">fillLine</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span> <span class="n">orientation</span> <span class="o">=</span> <span class="n">qskQtOrientation</span><span class="p">(</span> <span class="n">gradient</span> <span class="p">);</span>

            <span class="k">const</span> <span class="n">ColorMapGradient</span> <span class="n">fillMap</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">(),</span> <span class="n">gradient</span><span class="p">.</span><span class="n">endColor</span><span class="p">()</span> <span class="p">);</span>
            <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderLine</span><span class="p">,</span> <span class="n">borderMap</span><span class="p">,</span> <span class="n">fillLine</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>

        <span class="k">const</span> <span class="n">BorderMapGradient</span> <span class="n">tl</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Top</span> <span class="p">),</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">const</span> <span class="n">BorderMapGradient</span> <span class="n">tr</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Right</span> <span class="p">),</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Top</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">const</span> <span class="n">BorderMapGradient</span> <span class="n">bl</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Left</span> <span class="p">),</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Bottom</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">const</span> <span class="n">BorderMapGradient</span> <span class="n">br</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Bottom</span> <span class="p">),</span> <span class="n">bc</span><span class="p">.</span><span class="n">rgb</span><span class="p">(</span> <span class="n">Qsk</span><span class="o">::</span><span class="n">Right</span> <span class="p">)</span> <span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="n">ColorMapSolid</span> <span class="n">fillMap</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">()</span> <span class="p">);</span>
            <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span><span class="p">,</span> <span class="n">borderLine</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">bl</span><span class="p">,</span> <span class="n">br</span><span class="p">,</span> <span class="n">fillLine</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">const</span> <span class="k">auto</span> <span class="n">orientation</span> <span class="o">=</span> <span class="n">qskQtOrientation</span><span class="p">(</span> <span class="n">gradient</span> <span class="p">);</span>

            <span class="k">const</span> <span class="n">ColorMapGradient</span> <span class="n">fillMap</span><span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">startColor</span><span class="p">(),</span> <span class="n">gradient</span><span class="p">.</span><span class="n">endColor</span><span class="p">()</span> <span class="p">);</span>
            <span class="n">qskRenderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderLine</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">,</span> <span class="n">bl</span><span class="p">,</span> <span class="n">br</span><span class="p">,</span> <span class="n">fillLine</span><span class="p">,</span> <span class="n">fillMap</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskRenderFillOrdered</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">&amp;</span> <span class="n">metrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">ColoredLine</span><span class="o">*</span> <span class="n">lines</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span><span class="o">&amp;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">;</span>

    <span class="cm">/*
        The algo for irregular radii at opposite corners is not yet
        implemented TODO ...
     */</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Horizontal</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">HRectEllipseIterator</span> <span class="n">it</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">);</span>
        <span class="n">QskVertex</span><span class="o">::</span><span class="n">fillOrdered</span><span class="p">(</span> <span class="n">it</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">left</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">right</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">lines</span> <span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">VRectEllipseIterator</span> <span class="n">it</span><span class="p">(</span> <span class="n">metrics</span> <span class="p">);</span>
        <span class="n">QskVertex</span><span class="o">::</span><span class="n">fillOrdered</span><span class="p">(</span> <span class="n">it</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">top</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">lines</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">Metrics</span><span class="o">::</span><span class="n">Metrics</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span>
        <span class="k">const</span> <span class="n">QskBoxShapeMetrics</span><span class="o">&amp;</span> <span class="n">shape</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxBorderMetrics</span><span class="o">&amp;</span> <span class="n">border</span> <span class="p">)</span>
    <span class="o">:</span> <span class="n">outerQuad</span><span class="p">(</span> <span class="n">rect</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">isRadiusRegular</span> <span class="o">=</span> <span class="n">shape</span><span class="p">.</span><span class="n">isRectellipse</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">corner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>

        <span class="k">const</span> <span class="n">QSizeF</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">shape</span><span class="p">.</span><span class="n">radius</span><span class="p">(</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Corner</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span> <span class="p">);</span>
        <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span> <span class="o">=</span> <span class="n">qBound</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">radius</span><span class="p">.</span><span class="n">width</span><span class="p">(),</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">width</span> <span class="p">);</span>
        <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="o">=</span> <span class="n">qBound</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">radius</span><span class="p">.</span><span class="n">height</span><span class="p">(),</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">height</span> <span class="p">);</span>
        <span class="n">c</span><span class="p">.</span><span class="n">stepCount</span> <span class="o">=</span> <span class="n">ArcIterator</span><span class="o">::</span><span class="n">segmentHint</span><span class="p">(</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">,</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="p">)</span> <span class="p">);</span>

        <span class="k">switch</span> <span class="p">(</span> <span class="n">i</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">TopLeft</span><span class="p">:</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="n">TopRight</span><span class="p">:</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="n">BottomLeft</span><span class="p">:</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">+</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="n">BottomRight</span><span class="p">:</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">corner</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerX</span><span class="p">,</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerX</span> <span class="p">);</span>

    <span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span> <span class="n">corner</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerX</span><span class="p">,</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerX</span> <span class="p">);</span>

    <span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">corner</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">centerY</span><span class="p">,</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="p">);</span>

    <span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span> <span class="n">corner</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">centerY</span><span class="p">,</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">centerY</span> <span class="p">);</span>

    <span class="n">centerQuad</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">;</span>
    <span class="n">centerQuad</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">;</span>

    <span class="c1">// now the bounding rectangle of the fill area</span>

    <span class="k">const</span> <span class="k">auto</span> <span class="n">bw</span> <span class="o">=</span> <span class="n">border</span><span class="p">.</span><span class="n">widths</span><span class="p">();</span>

    <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">+</span> <span class="n">bw</span><span class="p">.</span><span class="n">left</span><span class="p">();</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">bw</span><span class="p">.</span><span class="n">right</span><span class="p">();</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">+</span> <span class="n">bw</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">bw</span><span class="p">.</span><span class="n">bottom</span><span class="p">();</span>

    <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">,</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">);</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span><span class="p">,</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">left</span> <span class="p">);</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">qMin</span><span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">,</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">);</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">=</span> <span class="n">qMax</span><span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">&gt;</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">=</span>
            <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&gt;</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">=</span>
            <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="n">innerQuad</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">;</span>
    <span class="n">innerQuad</span><span class="p">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">;</span>

    <span class="k">const</span> <span class="n">qreal</span> <span class="n">borderLeft</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="o">-</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">borderTop</span> <span class="o">=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">-</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">borderRight</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span><span class="p">;</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">borderBottom</span> <span class="o">=</span> <span class="n">outerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="o">-</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">auto</span><span class="o">&amp;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">corner</span><span class="p">[</span> <span class="n">i</span> <span class="p">];</span>

        <span class="k">switch</span> <span class="p">(</span> <span class="n">i</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">TopLeft</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span> <span class="o">-</span> <span class="n">borderLeft</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="o">-</span> <span class="n">borderTop</span><span class="p">;</span>

                <span class="n">c</span><span class="p">.</span><span class="n">isCropped</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">&lt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="p">)</span> <span class="o">||</span>
                    <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">&lt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="p">);</span>

                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">TopRight</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span> <span class="o">-</span> <span class="n">borderRight</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="o">-</span> <span class="n">borderTop</span><span class="p">;</span>

                <span class="n">c</span><span class="p">.</span><span class="n">isCropped</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">&gt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span> <span class="o">||</span>
                    <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">&lt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">BottomLeft</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span> <span class="o">-</span> <span class="n">borderLeft</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="o">-</span> <span class="n">borderBottom</span><span class="p">;</span>

                <span class="n">c</span><span class="p">.</span><span class="n">isCropped</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">&lt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span> <span class="p">)</span> <span class="o">||</span>
                    <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">&gt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">BottomRight</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerX</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusX</span> <span class="o">-</span> <span class="n">borderRight</span><span class="p">;</span>
                <span class="n">c</span><span class="p">.</span><span class="n">radiusInnerY</span> <span class="o">=</span> <span class="n">c</span><span class="p">.</span><span class="n">radiusY</span> <span class="o">-</span> <span class="n">borderBottom</span><span class="p">;</span>

                <span class="n">c</span><span class="p">.</span><span class="n">isCropped</span> <span class="o">=</span> <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerX</span> <span class="o">&gt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">right</span> <span class="p">)</span> <span class="o">||</span>
                    <span class="p">(</span> <span class="n">c</span><span class="p">.</span><span class="n">centerY</span> <span class="o">&gt;=</span> <span class="n">innerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">isTotallyCropped</span> <span class="o">=</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">TopLeft</span> <span class="p">].</span><span class="n">isCropped</span> <span class="o">&amp;&amp;</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">TopRight</span> <span class="p">].</span><span class="n">isCropped</span> <span class="o">&amp;&amp;</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">BottomRight</span> <span class="p">].</span><span class="n">isCropped</span> <span class="o">&amp;&amp;</span>
        <span class="n">corner</span><span class="p">[</span> <span class="n">BottomLeft</span> <span class="p">].</span><span class="n">isCropped</span><span class="p">;</span>

    <span class="c1">// number of steps for iterating over the corners</span>

    <span class="n">isBorderRegular</span> <span class="o">=</span>
        <span class="p">(</span> <span class="n">borderLeft</span> <span class="o">==</span> <span class="n">borderTop</span> <span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="p">(</span> <span class="n">borderTop</span> <span class="o">==</span> <span class="n">borderRight</span> <span class="p">)</span> <span class="o">&amp;&amp;</span>
        <span class="p">(</span> <span class="n">borderRight</span> <span class="o">==</span> <span class="n">borderBottom</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">renderRectellipseBorder</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxShapeMetrics</span><span class="o">&amp;</span> <span class="n">shape</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxBorderMetrics</span><span class="o">&amp;</span> <span class="n">border</span><span class="p">,</span> <span class="n">QSGGeometry</span><span class="o">&amp;</span> <span class="n">geometry</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="n">Metrics</span> <span class="n">metrics</span><span class="p">(</span> <span class="n">rect</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">border</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span> <span class="o">==</span> <span class="n">metrics</span><span class="p">.</span><span class="n">outerQuad</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">allocateLines</span><span class="o">&lt;</span> <span class="n">Line</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">geometry</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">lineCount</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="k">const</span> <span class="k">auto</span> <span class="n">line</span> <span class="o">=</span> <span class="n">allocateLines</span><span class="o">&lt;</span> <span class="n">Line</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">lineCount</span> <span class="p">);</span>
    <span class="n">qskRenderBorderLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">BorderMapNone</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">renderRectellipseFill</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxShapeMetrics</span><span class="o">&amp;</span> <span class="n">shape</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxBorderMetrics</span><span class="o">&amp;</span> <span class="n">border</span><span class="p">,</span> <span class="n">QSGGeometry</span><span class="o">&amp;</span> <span class="n">geometry</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="n">Metrics</span> <span class="n">metrics</span><span class="p">(</span> <span class="n">rect</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">border</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">||</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">height</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">allocateLines</span><span class="o">&lt;</span> <span class="n">Line</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">geometry</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isTotallyCropped</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// degenerated to a rectangle</span>

        <span class="k">const</span> <span class="n">QRectF</span> <span class="n">r</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">left</span><span class="p">,</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">top</span><span class="p">,</span>
            <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">height</span> <span class="p">);</span>

        <span class="n">renderRectFill</span><span class="p">(</span> <span class="n">r</span><span class="p">,</span> <span class="n">QskBoxShapeMetrics</span><span class="p">(),</span>
            <span class="n">QskBoxBorderMetrics</span><span class="p">(),</span> <span class="n">geometry</span> <span class="p">);</span>

        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">lineCount</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">top</span> <span class="o">&gt;=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">bottom</span> <span class="p">)</span>
        <span class="n">lineCount</span><span class="o">++</span><span class="p">;</span>

    <span class="k">const</span> <span class="k">auto</span> <span class="n">line</span> <span class="o">=</span> <span class="n">allocateLines</span><span class="o">&lt;</span> <span class="n">Line</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">lineCount</span> <span class="p">);</span>
    <span class="n">qskRenderFillLines</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">ColorMapNone</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">QskBoxRenderer</span><span class="o">::</span><span class="n">renderRectellipse</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxShapeMetrics</span><span class="o">&amp;</span> <span class="n">shape</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskBoxBorderMetrics</span><span class="o">&amp;</span> <span class="n">border</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QskBoxBorderColors</span><span class="o">&amp;</span> <span class="n">borderColors</span><span class="p">,</span> <span class="k">const</span> <span class="n">QskGradient</span><span class="o">&amp;</span> <span class="n">gradient</span><span class="p">,</span>
    <span class="n">QSGGeometry</span><span class="o">&amp;</span> <span class="n">geometry</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="n">Metrics</span> <span class="n">metrics</span><span class="p">(</span> <span class="n">rect</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">border</span> <span class="p">);</span>

    <span class="kt">int</span> <span class="n">fillLineCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">gradient</span><span class="p">.</span><span class="n">isVisible</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isTotallyCropped</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// degenerated to a rectangle</span>

            <span class="n">fillLineCount</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">.</span><span class="n">stops</span><span class="p">().</span><span class="n">count</span><span class="p">();</span>

<span class="cp">#if 1
</span>            <span class="c1">// code copied from QskBoxRendererRect.cpp TODO ...</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">width</span> <span class="o">==</span> <span class="n">metrics</span><span class="p">.</span><span class="n">centerQuad</span><span class="p">.</span><span class="n">height</span> <span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">gradient</span><span class="p">.</span><span class="n">hasStopAt</span><span class="p">(</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="p">)</span>
                        <span class="n">fillLineCount</span><span class="o">++</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="c1">// we might need extra lines for the corners</span>
                    <span class="n">fillLineCount</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
<span class="cp">#endif
</span>        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">fillLineCount</span> <span class="o">=</span> <span class="n">qskFillLineCount</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span> <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">stepCount</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">corner</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">stepCount</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">borderLineCount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">borderColors</span><span class="p">.</span><span class="n">isVisible</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span> <span class="o">!=</span> <span class="n">metrics</span><span class="p">.</span><span class="n">outerQuad</span> <span class="p">)</span>
        <span class="n">borderLineCount</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span> <span class="n">stepCount</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">lineCount</span> <span class="o">=</span> <span class="n">borderLineCount</span> <span class="o">+</span> <span class="n">fillLineCount</span><span class="p">;</span>

    <span class="kt">bool</span> <span class="n">extraLine</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">borderLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">fillLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
            <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span> <span class="p">)</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="cm">/*
                The filling ends at 45Â° and we have no implementation
                for creating the border from there. So we need to
                insert an extra dummy line to connect fill and border
             */</span>
            <span class="n">extraLine</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="n">lineCount</span><span class="o">++</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">auto</span> <span class="n">line</span> <span class="o">=</span> <span class="n">allocateLines</span><span class="o">&lt;</span> <span class="n">ColoredLine</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">geometry</span><span class="p">,</span> <span class="n">lineCount</span> <span class="p">);</span>

    <span class="kt">bool</span> <span class="n">fillRandom</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">fillLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isTotallyCropped</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">fillRandom</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">gradient</span><span class="p">.</span><span class="n">isMonochrome</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">stops</span><span class="p">().</span><span class="n">count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">||</span>
                <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">fillRandom</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">fillRandom</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">metrics</span><span class="p">.</span><span class="n">isRadiusRegular</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="cm">/*
                    When we have a combination of corners with the same
                    or no radius we could use the faster random algo: TODO ...
                 */</span>
                <span class="n">fillRandom</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="p">(</span> <span class="n">fillLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">borderLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">fillRandom</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">qskRenderBoxRandom</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">borderColors</span><span class="p">,</span>
                <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">line</span> <span class="o">+</span> <span class="n">fillLineCount</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isTotallyCropped</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">renderRectFill</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">renderDiagonalFill</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">fillLineCount</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">qskRenderFillOrdered</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>

            <span class="k">auto</span> <span class="n">borderLines</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">fillLineCount</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">extraLine</span> <span class="p">)</span>
                <span class="n">borderLines</span><span class="o">++</span><span class="p">;</span>

            <span class="k">const</span> <span class="k">auto</span> <span class="n">orientation</span> <span class="o">=</span> <span class="n">qskQtOrientation</span><span class="p">(</span> <span class="n">gradient</span> <span class="p">);</span>
            <span class="n">qskRenderBorder</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">orientation</span><span class="p">,</span> <span class="n">borderColors</span><span class="p">,</span> <span class="n">borderLines</span> <span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span> <span class="n">extraLine</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="k">const</span> <span class="k">auto</span> <span class="n">l</span> <span class="o">=</span> <span class="n">line</span> <span class="o">+</span> <span class="n">fillLineCount</span><span class="p">;</span>
                <span class="n">l</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">p1</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span> <span class="o">-</span><span class="mi">1</span> <span class="p">].</span><span class="n">p2</span><span class="p">;</span>
                <span class="n">l</span><span class="p">[</span> <span class="mi">0</span> <span class="p">].</span><span class="n">p2</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span> <span class="mi">1</span> <span class="p">].</span><span class="n">p1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">fillLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">fillRandom</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">qskRenderFillRandom</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">isTotallyCropped</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">renderRectFill</span><span class="p">(</span> <span class="n">metrics</span><span class="p">.</span><span class="n">innerQuad</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">gradient</span><span class="p">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">==</span> <span class="n">QskGradient</span><span class="o">::</span><span class="n">Diagonal</span> <span class="p">)</span>
            <span class="p">{</span>
                <span class="n">renderDiagonalFill</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">fillLineCount</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>
            <span class="k">else</span>
            <span class="p">{</span>
                <span class="n">qskRenderFillOrdered</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">gradient</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span> <span class="n">borderLineCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
<span class="cp">#if 1
</span>        <span class="cm">/*
            In case of having an empty innerQuad and monochrome
            border colors, we could treat it like filling without border. TODO ...
         */</span>
<span class="cp">#endif
</span>        <span class="n">qskRenderBorder</span><span class="p">(</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Vertical</span><span class="p">,</span> <span class="n">borderColors</span><span class="p">,</span> <span class="n">line</span> <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<p>Updated on 28 July 2023 at 14:02:30 CEST</p>
