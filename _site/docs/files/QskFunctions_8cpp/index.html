<h1 id="commonqskfunctionscpp">common/QskFunctions.cpp</h1>

<h2 id="functions">Functions</h2>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>template &lt;class Rect ,class Value &gt; <br />Rect</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskalignedrect">qskAlignedRect</a></strong>(const Rect &amp; outerRect, Value width, Value height, Qt::Alignment alignment)</td>
    </tr>
    <tr>
      <td>QRect</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskalignedrect">qskAlignedRect</a></strong>(const QRect &amp; outerRect, int width, int height, Qt::Alignment alignment)</td>
    </tr>
    <tr>
      <td>QRectF</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskalignedrectf">qskAlignedRectF</a></strong>(const QRectF &amp; outerRect, qreal width, qreal height, Qt::Alignment alignment)</td>
    </tr>
    <tr>
      <td>QRect</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskinnerrect">qskInnerRect</a></strong>(const QRectF &amp; rect)</td>
    </tr>
    <tr>
      <td>QRectF</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskinnerrectf">qskInnerRectF</a></strong>(const QRectF &amp; rect)</td>
    </tr>
    <tr>
      <td>QRectF</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskvalidoremptyinnerrect">qskValidOrEmptyInnerRect</a></strong>(const QRectF &amp; rect, const QMarginsF &amp; margins)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskdpiscaled">qskDpiScaled</a></strong>(qreal value)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskhorizontaladvance">qskHorizontalAdvance</a></strong>(const QFont &amp; font, const QString &amp; text)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskhorizontaladvance">qskHorizontalAdvance</a></strong>(const QFontMetricsF &amp; fontMetrics, const QString &amp; text)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskglobalscalefactor">qskGlobalScaleFactor</a></strong>()</td>
    </tr>
    <tr>
      <td>bool</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskhasplatformwindowmanagement">qskHasPlatformWindowManagement</a></strong>()</td>
    </tr>
    <tr>
      <td>QRect</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskplatformscreengeometry">qskPlatformScreenGeometry</a></strong>(const QScreen * screen)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskfuzzyfloor">qskFuzzyFloor</a></strong>(qreal value, qreal stepSize)</td>
    </tr>
    <tr>
      <td>qreal</td>
      <td><strong><a href="/docs/files/QskFunctions_8cpp/#function-qskfuzzyceil">qskFuzzyCeil</a></strong>(qreal value, qreal stepSize)</td>
    </tr>
  </tbody>
</table>

<h2 id="functions-documentation">Functions Documentation</h2>

<h3 id="function-qskalignedrect">function qskAlignedRect</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">Rect</span> <span class="p">,</span>
<span class="k">class</span> <span class="nc">Value</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">Rect</span> <span class="n">qskAlignedRect</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">Rect</span> <span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="n">Value</span> <span class="n">width</span><span class="p">,</span>
    <span class="n">Value</span> <span class="n">height</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskalignedrect-1">function qskAlignedRect</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRect</span> <span class="n">qskAlignedRect</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRect</span> <span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">width</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">height</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskalignedrectf">function qskAlignedRectF</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRectF</span> <span class="n">qskAlignedRectF</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span> <span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="n">qreal</span> <span class="n">width</span><span class="p">,</span>
    <span class="n">qreal</span> <span class="n">height</span><span class="p">,</span>
    <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskinnerrect">function qskInnerRect</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRect</span> <span class="n">qskInnerRect</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span> <span class="o">&amp;</span> <span class="n">rect</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskinnerrectf">function qskInnerRectF</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRectF</span> <span class="n">qskInnerRectF</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span> <span class="o">&amp;</span> <span class="n">rect</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskvalidoremptyinnerrect">function qskValidOrEmptyInnerRect</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRectF</span> <span class="n">qskValidOrEmptyInnerRect</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QRectF</span> <span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QMarginsF</span> <span class="o">&amp;</span> <span class="n">margins</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskdpiscaled">function qskDpiScaled</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskDpiScaled</span><span class="p">(</span>
    <span class="n">qreal</span> <span class="n">value</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskhorizontaladvance">function qskHorizontalAdvance</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskHorizontalAdvance</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QFont</span> <span class="o">&amp;</span> <span class="n">font</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span> <span class="n">text</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskhorizontaladvance-1">function qskHorizontalAdvance</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskHorizontalAdvance</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QFontMetricsF</span> <span class="o">&amp;</span> <span class="n">fontMetrics</span><span class="p">,</span>
    <span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span> <span class="n">text</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskglobalscalefactor">function qskGlobalScaleFactor</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskGlobalScaleFactor</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="function-qskhasplatformwindowmanagement">function qskHasPlatformWindowManagement</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">bool</span> <span class="n">qskHasPlatformWindowManagement</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="function-qskplatformscreengeometry">function qskPlatformScreenGeometry</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">QRect</span> <span class="n">qskPlatformScreenGeometry</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QScreen</span> <span class="o">*</span> <span class="n">screen</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskfuzzyfloor">function qskFuzzyFloor</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskFuzzyFloor</span><span class="p">(</span>
    <span class="n">qreal</span> <span class="n">value</span><span class="p">,</span>
    <span class="n">qreal</span> <span class="n">stepSize</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskfuzzyceil">function qskFuzzyCeil</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qreal</span> <span class="n">qskFuzzyCeil</span><span class="p">(</span>
    <span class="n">qreal</span> <span class="n">value</span><span class="p">,</span>
    <span class="n">qreal</span> <span class="n">stepSize</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="source-code">Source code</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include "QskFunctions.h"
</span>
<span class="cp">#include &lt;qguiapplication.h&gt;
#include &lt;qmath.h&gt;
#include &lt;qscreen.h&gt;
#include &lt;qfont.h&gt;
#include &lt;qfontmetrics.h&gt;
</span>

<span class="cp">#include &lt;private/qguiapplication_p.h&gt;
</span>
<span class="cp">#if QT_VERSION &lt; QT_VERSION_CHECK( 5, 8, 0 )
</span>    <span class="cp">#ifndef foreach
</span>        <span class="c1">// qhighdpiscaling_p.h needs it</span>
        <span class="cp">#define foreach Q_FOREACH
</span>    <span class="cp">#endif
#endif
</span>
<span class="cp">#include &lt;private/qhighdpiscaling_p.h&gt;
</span>

<span class="cp">#include &lt;qpa/qplatformintegration.h&gt;
#include &lt;qpa/qplatformscreen.h&gt;
</span>
<span class="cp">#include &lt;cmath&gt;
</span>
<span class="k">template</span><span class="o">&lt;</span> <span class="k">class</span> <span class="nc">Rect</span><span class="p">,</span> <span class="k">class</span> <span class="nc">Value</span> <span class="p">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">Rect</span> <span class="nf">qskAlignedRect</span><span class="p">(</span> <span class="k">const</span> <span class="n">Rect</span><span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="n">Value</span> <span class="n">width</span><span class="p">,</span> <span class="n">Value</span> <span class="n">height</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">Value</span> <span class="n">x</span> <span class="o">=</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">x</span><span class="p">();</span>
    <span class="n">Value</span> <span class="n">y</span> <span class="o">=</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">y</span><span class="p">();</span>

    <span class="k">switch</span> <span class="p">(</span> <span class="n">alignment</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignHorizontal_Mask</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignHCenter</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="n">width</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="k">case</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignRight</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="n">width</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="nl">default:</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">switch</span> <span class="p">(</span> <span class="n">alignment</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignVertical_Mask</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">case</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignVCenter</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="p">(</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">height</span> <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="k">case</span> <span class="n">Qt</span><span class="o">::</span><span class="n">AlignBottom</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="n">outerRect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">height</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>

        <span class="nl">default:</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">Rect</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QRect</span> <span class="nf">qskAlignedRect</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRect</span><span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">qskAlignedRect</span><span class="o">&lt;</span> <span class="n">QRect</span><span class="p">,</span> <span class="kt">int</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">outerRect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">alignment</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QRectF</span> <span class="nf">qskAlignedRectF</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">outerRect</span><span class="p">,</span>
    <span class="n">qreal</span> <span class="n">width</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">height</span><span class="p">,</span> <span class="n">Qt</span><span class="o">::</span><span class="n">Alignment</span> <span class="n">alignment</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">qskAlignedRect</span><span class="o">&lt;</span> <span class="n">QRectF</span><span class="p">,</span> <span class="n">qreal</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">outerRect</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">alignment</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QRect</span> <span class="nf">qskInnerRect</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="n">qCeil</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">top</span> <span class="o">=</span> <span class="n">qCeil</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">right</span> <span class="o">=</span> <span class="n">qFloor</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">right</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="kt">int</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">qFloor</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">bottom</span><span class="p">()</span> <span class="p">);</span>

    <span class="k">return</span> <span class="n">QRect</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QRectF</span> <span class="nf">qskInnerRectF</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">left</span> <span class="o">=</span> <span class="n">qCeil</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">top</span> <span class="o">=</span> <span class="n">qCeil</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">right</span> <span class="o">=</span> <span class="n">qFloor</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">right</span><span class="p">()</span> <span class="p">);</span>
    <span class="k">const</span> <span class="n">qreal</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">qFloor</span><span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">bottom</span><span class="p">()</span> <span class="p">);</span>

    <span class="k">return</span> <span class="n">QRectF</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span> <span class="o">-</span> <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">-</span> <span class="n">top</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QRectF</span> <span class="nf">qskValidOrEmptyInnerRect</span><span class="p">(</span> <span class="k">const</span> <span class="n">QRectF</span><span class="o">&amp;</span> <span class="n">rect</span><span class="p">,</span> <span class="k">const</span> <span class="n">QMarginsF</span><span class="o">&amp;</span> <span class="n">margins</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">qreal</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">qreal</span> <span class="n">marginsWidth</span> <span class="o">=</span> <span class="n">margins</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="o">+</span> <span class="n">margins</span><span class="p">.</span><span class="n">right</span><span class="p">();</span>

        <span class="k">if</span> <span class="p">(</span> <span class="n">marginsWidth</span> <span class="o">&gt;</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">x</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span> <span class="n">margins</span><span class="p">.</span><span class="n">left</span><span class="p">()</span> <span class="o">/</span> <span class="n">marginsWidth</span> <span class="p">);</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">x</span><span class="p">()</span> <span class="o">+</span> <span class="n">margins</span><span class="p">.</span><span class="n">left</span><span class="p">();</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="n">marginsWidth</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">x</span><span class="p">();</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">const</span> <span class="n">qreal</span> <span class="n">marginsHeight</span> <span class="o">=</span> <span class="n">margins</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">+</span> <span class="n">margins</span><span class="p">.</span><span class="n">bottom</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">marginsHeight</span> <span class="o">&gt;</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">y</span><span class="p">()</span> <span class="o">+</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span> <span class="n">margins</span><span class="p">.</span><span class="n">top</span><span class="p">()</span> <span class="o">/</span> <span class="n">marginsHeight</span> <span class="p">);</span>
            <span class="n">h</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span>
        <span class="p">{</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">y</span><span class="p">()</span> <span class="o">+</span> <span class="n">margins</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">marginsHeight</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="p">.</span><span class="n">y</span><span class="p">();</span>
        <span class="n">h</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">QRectF</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskDpiScaled</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">value</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="n">qreal</span> <span class="n">factor</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">factor</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span> <span class="k">const</span> <span class="n">QScreen</span><span class="o">*</span> <span class="n">screen</span> <span class="o">=</span> <span class="n">QGuiApplication</span><span class="o">::</span><span class="n">primaryScreen</span><span class="p">()</span> <span class="p">)</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="n">screen</span><span class="o">-&gt;</span><span class="n">logicalDotsPerInchX</span><span class="p">();</span>
        <span class="k">else</span>
            <span class="n">factor</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">;</span>

        <span class="n">factor</span> <span class="o">/=</span> <span class="mf">96.0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">factor</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskHorizontalAdvance</span><span class="p">(</span> <span class="k">const</span> <span class="n">QFont</span><span class="o">&amp;</span> <span class="n">font</span><span class="p">,</span> <span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">text</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">qskHorizontalAdvance</span><span class="p">(</span> <span class="n">QFontMetricsF</span><span class="p">(</span> <span class="n">font</span> <span class="p">),</span> <span class="n">text</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskHorizontalAdvance</span><span class="p">(</span> <span class="k">const</span> <span class="n">QFontMetricsF</span><span class="o">&amp;</span> <span class="n">fontMetrics</span><span class="p">,</span> <span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">text</span> <span class="p">)</span>
<span class="p">{</span>
<span class="cp">#if QT_VERSION &gt;= QT_VERSION_CHECK( 5, 11, 0 )
</span>    <span class="k">return</span> <span class="n">fontMetrics</span><span class="p">.</span><span class="n">horizontalAdvance</span><span class="p">(</span> <span class="n">text</span> <span class="p">);</span>
<span class="cp">#else
</span>    <span class="k">return</span> <span class="n">fontMetrics</span><span class="p">.</span><span class="n">width</span><span class="p">(</span> <span class="n">text</span> <span class="p">);</span>
<span class="cp">#endif
</span><span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskGlobalScaleFactor</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// The value of QT_SCALE_FACTOR</span>
    <span class="k">const</span> <span class="n">QScreen</span><span class="o">*</span> <span class="n">noScreen</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">QHighDpiScaling</span><span class="o">::</span><span class="n">factor</span><span class="p">(</span> <span class="n">noScreen</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="nf">qskHasPlatformWindowManagement</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="k">auto</span> <span class="n">platform</span> <span class="o">=</span> <span class="n">QGuiApplicationPrivate</span><span class="o">::</span><span class="n">platformIntegration</span><span class="p">()</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">platform</span><span class="o">-&gt;</span><span class="n">hasCapability</span><span class="p">(</span> <span class="n">QPlatformIntegration</span><span class="o">::</span><span class="n">WindowManagement</span> <span class="p">);</span>

    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">QRect</span> <span class="nf">qskPlatformScreenGeometry</span><span class="p">(</span> <span class="k">const</span> <span class="n">QScreen</span><span class="o">*</span> <span class="n">screen</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">screen</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">QRect</span><span class="p">();</span>

    <span class="k">return</span> <span class="n">screen</span><span class="o">-&gt;</span><span class="n">handle</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">geometry</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskFuzzyFloor</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">value</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">stepSize</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0e-6</span> <span class="o">*</span> <span class="n">stepSize</span><span class="p">;</span>

    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="n">value</span> <span class="o">+</span> <span class="n">eps</span> <span class="p">)</span> <span class="o">/</span> <span class="n">stepSize</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">floor</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="o">*</span> <span class="n">stepSize</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">qreal</span> <span class="nf">qskFuzzyCeil</span><span class="p">(</span> <span class="n">qreal</span> <span class="n">value</span><span class="p">,</span> <span class="n">qreal</span> <span class="n">stepSize</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">double</span> <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0e-6</span> <span class="o">*</span> <span class="n">stepSize</span><span class="p">;</span>

    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span> <span class="n">value</span> <span class="o">-</span> <span class="n">eps</span> <span class="p">)</span> <span class="o">/</span> <span class="n">stepSize</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">ceil</span><span class="p">(</span> <span class="n">value</span> <span class="p">)</span> <span class="o">*</span> <span class="n">stepSize</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<p>Updated on 28 July 2023 at 14:02:29 CEST</p>
