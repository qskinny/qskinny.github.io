<h1 id="graphicqskgraphiciocpp">graphic/QskGraphicIO.cpp</h1>

<h2 id="functions">Functions</h2>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskwritepathdata">qskWritePathData</a></strong>(const QPainterPath &amp; path, QDataStream &amp; s)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskreadpathdata">qskReadPathData</a></strong>(QDataStream &amp; s, QVector&lt; QskPainterCommand &gt; &amp; commands)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskwritepixmapdata">qskWritePixmapData</a></strong>(const QskPainterCommand::PixmapData &amp; data, QDataStream &amp; s)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskreadpixmapdata">qskReadPixmapData</a></strong>(QDataStream &amp; s, QVector&lt; QskPainterCommand &gt; &amp; commands)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskwriteimagedata">qskWriteImageData</a></strong>(const QskPainterCommand::ImageData &amp; data, QDataStream &amp; s)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskreadimagedata">qskReadImageData</a></strong>(QDataStream &amp; s, QVector&lt; QskPainterCommand &gt; &amp; commands)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskwritestatedata">qskWriteStateData</a></strong>(const QskPainterCommand::StateData &amp; data, QDataStream &amp; s)</td>
    </tr>
    <tr>
      <td>void</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#function-qskreadstatedata">qskReadStateData</a></strong>(QDataStream &amp; s, QVector&lt; QskPainterCommand &gt; &amp; commands)</td>
    </tr>
  </tbody>
</table>

<h2 id="attributes">Attributes</h2>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>const char</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#variable-qskmagicnumber">qskMagicNumber</a></strong></td>
    </tr>
    <tr>
      <td>const int</td>
      <td><strong><a href="/docs/files/QskGraphicIO_8cpp/#variable-qskdatastreamversion">qskDataStreamVersion</a></strong></td>
    </tr>
  </tbody>
</table>

<h2 id="functions-documentation">Functions Documentation</h2>

<h3 id="function-qskwritepathdata">function qskWritePathData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskWritePathData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QPainterPath</span> <span class="o">&amp;</span> <span class="n">path</span><span class="p">,</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskreadpathdata">function qskReadPathData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskReadPathData</span><span class="p">(</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span>
    <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">commands</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskwritepixmapdata">function qskWritePixmapData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskWritePixmapData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">PixmapData</span> <span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskreadpixmapdata">function qskReadPixmapData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskReadPixmapData</span><span class="p">(</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span>
    <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">commands</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskwriteimagedata">function qskWriteImageData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskWriteImageData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">ImageData</span> <span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskreadimagedata">function qskReadImageData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskReadImageData</span><span class="p">(</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span>
    <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">commands</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskwritestatedata">function qskWriteStateData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskWriteStateData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">StateData</span> <span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="function-qskreadstatedata">function qskReadStateData</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">qskReadStateData</span><span class="p">(</span>
    <span class="n">QDataStream</span> <span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span>
    <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;</span> <span class="o">&amp;</span> <span class="n">commands</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="attributes-documentation">Attributes Documentation</h2>

<h3 id="variable-qskmagicnumber">variable qskMagicNumber</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">qskMagicNumber</span> <span class="o">=</span> <span class="s">"QSKG"</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="variable-qskdatastreamversion">variable qskDataStreamVersion</h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">qskDataStreamVersion</span> <span class="o">=</span> <span class="n">QDataStream</span><span class="o">::</span><span class="n">Qt_5_6</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="source-code">Source code</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/******************************************************************************
 * QSkinny - Copyright (C) 2016 Uwe Rathmann
 * This file may be used under the terms of the QSkinny License, Version 1.0
 *****************************************************************************/</span>

<span class="cp">#include "QskGraphicIO.h"
#include "QskGraphic.h"
#include "QskPainterCommand.h"
</span>
<span class="cp">#include &lt;qbuffer.h&gt;
#include &lt;qdatastream.h&gt;
#include &lt;qfile.h&gt;
#include &lt;qvector.h&gt;
</span>
<span class="cp">#include &lt;cstring&gt;
</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">qskMagicNumber</span><span class="p">[]</span> <span class="o">=</span> <span class="s">"QSKG"</span><span class="p">;</span>

<span class="cm">/*
    To avoid crashes ( fonts ), when svg2qvg was running with a different Qt
    version, than the one of the application we hardcode
    the datastream format to Qt 5.6. Once everything is running with
    Qt 5.15 we can increase the version. TODO ...
 */</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">qskDataStreamVersion</span> <span class="o">=</span> <span class="n">QDataStream</span><span class="o">::</span><span class="n">Qt_5_6</span><span class="p">;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskWritePathData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QPainterPath</span><span class="o">&amp;</span> <span class="n">path</span><span class="p">,</span> <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">path</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskReadPathData</span><span class="p">(</span>
    <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;&amp;</span> <span class="n">commands</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QPainterPath</span> <span class="n">path</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">path</span><span class="p">;</span>

    <span class="n">commands</span> <span class="o">+=</span> <span class="n">QskPainterCommand</span><span class="p">(</span> <span class="n">path</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskWritePixmapData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">PixmapData</span><span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span> <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">pixmap</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskReadPixmapData</span><span class="p">(</span>
    <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;&amp;</span> <span class="n">commands</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">PixmapData</span> <span class="n">data</span><span class="p">;</span>

    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">pixmap</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span><span class="p">;</span>

    <span class="n">commands</span> <span class="o">+=</span> <span class="n">QskPainterCommand</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">pixmap</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskWriteImageData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">ImageData</span><span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span> <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">image</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskReadImageData</span><span class="p">(</span>
    <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;&amp;</span> <span class="n">commands</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">ImageData</span> <span class="n">data</span><span class="p">;</span>

    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">image</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span><span class="p">;</span>

    <span class="n">quint8</span> <span class="n">flags</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">flags</span><span class="p">;</span>
    <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">ImageConversionFlags</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">flags</span> <span class="p">);</span>

    <span class="n">commands</span> <span class="o">+=</span> <span class="n">QskPainterCommand</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">rect</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">image</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">subRect</span><span class="p">,</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskWriteStateData</span><span class="p">(</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">StateData</span><span class="o">&amp;</span> <span class="n">data</span><span class="p">,</span> <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint16</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyPen</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">pen</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBrush</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">brush</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBrushOrigin</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">brushOrigin</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyFont</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">font</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBackground</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint8</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">backgroundMode</span> <span class="p">);</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">backgroundBrush</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyTransform</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">transform</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipEnabled</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">isClipEnabled</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipRegion</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">clipRegion</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint8</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">clipOperation</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipPath</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">clipPath</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint8</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">clipOperation</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyHints</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">qint32</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">renderHints</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyCompositionMode</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">qint16</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">compositionMode</span> <span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyOpacity</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&lt;&lt;</span> <span class="n">data</span><span class="p">.</span><span class="n">opacity</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qskReadStateData</span><span class="p">(</span>
    <span class="n">QDataStream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;&amp;</span> <span class="n">commands</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">StateData</span> <span class="n">data</span><span class="p">;</span>

    <span class="n">quint16</span> <span class="n">flags</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">flags</span><span class="p">;</span>

    <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="p">(</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyFlags</span> <span class="p">)</span> <span class="n">flags</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyPen</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">pen</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBrush</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">brush</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBrushOrigin</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">brushOrigin</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyFont</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">font</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyBackground</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">quint8</span> <span class="n">bgMode</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">backgroundMode</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">bgMode</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">backgroundBrush</span><span class="p">;</span>
        <span class="n">data</span><span class="p">.</span><span class="n">backgroundMode</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">BGMode</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">bgMode</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyTransform</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">transform</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipEnabled</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">isClipEnabled</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipRegion</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">clipRegion</span><span class="p">;</span>

        <span class="n">quint8</span> <span class="n">clipOperation</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">clipOperation</span><span class="p">;</span>
        <span class="n">data</span><span class="p">.</span><span class="n">clipOperation</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">ClipOperation</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">clipOperation</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyClipPath</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">clipPath</span><span class="p">;</span>

        <span class="n">quint8</span> <span class="n">clipOperation</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">clipOperation</span><span class="p">;</span>
        <span class="n">data</span><span class="p">.</span><span class="n">clipOperation</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">Qt</span><span class="o">::</span><span class="n">ClipOperation</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">clipOperation</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyHints</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qint32</span> <span class="n">renderHints</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">renderHints</span><span class="p">;</span>
        <span class="n">data</span><span class="p">.</span><span class="n">renderHints</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">QPainter</span><span class="o">::</span><span class="n">RenderHints</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">renderHints</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyCompositionMode</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qint16</span> <span class="n">compositionMode</span><span class="p">;</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">compositionMode</span><span class="p">;</span>
        <span class="n">data</span><span class="p">.</span><span class="n">compositionMode</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">QPainter</span><span class="o">::</span><span class="n">CompositionMode</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">compositionMode</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span> <span class="n">data</span><span class="p">.</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">QPaintEngine</span><span class="o">::</span><span class="n">DirtyOpacity</span> <span class="p">)</span>
        <span class="n">s</span> <span class="o">&gt;&gt;</span> <span class="n">data</span><span class="p">.</span><span class="n">opacity</span><span class="p">;</span>

    <span class="n">commands</span> <span class="o">+=</span> <span class="n">QskPainterCommand</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QskGraphic</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">read</span><span class="p">(</span> <span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">fileName</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QFile</span> <span class="n">file</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span> <span class="n">QIODevice</span><span class="o">::</span><span class="n">ReadOnly</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">false</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qWarning</span><span class="p">(</span> <span class="s">"QskGraphicIO::read can't open %s"</span><span class="p">,</span> <span class="n">qPrintable</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">return</span> <span class="n">QskGraphic</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">read</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">file</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QskGraphic</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">read</span><span class="p">(</span> <span class="k">const</span> <span class="n">QByteArray</span><span class="o">&amp;</span> <span class="n">data</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QBuffer</span> <span class="n">buffer</span><span class="p">;</span>
    <span class="n">buffer</span><span class="p">.</span><span class="n">setData</span><span class="p">(</span> <span class="n">data</span> <span class="p">);</span>

    <span class="k">return</span> <span class="n">read</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">buffer</span> <span class="p">);</span>
<span class="p">}</span>

<span class="n">QskGraphic</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">read</span><span class="p">(</span> <span class="n">QIODevice</span><span class="o">*</span> <span class="n">dev</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dev</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">QskGraphic</span><span class="p">();</span>

    <span class="n">QDataStream</span> <span class="n">stream</span><span class="p">(</span> <span class="n">dev</span> <span class="p">);</span>
<span class="cp">#if 1
</span>    <span class="n">stream</span><span class="p">.</span><span class="n">setVersion</span><span class="p">(</span> <span class="n">qskDataStreamVersion</span> <span class="p">);</span>
<span class="cp">#endif
</span>    <span class="n">stream</span><span class="p">.</span><span class="n">setByteOrder</span><span class="p">(</span> <span class="n">QDataStream</span><span class="o">::</span><span class="n">BigEndian</span> <span class="p">);</span>

    <span class="kt">char</span> <span class="n">magicNumber</span><span class="p">[</span> <span class="mi">4</span> <span class="p">];</span>
    <span class="n">stream</span><span class="p">.</span><span class="n">readRawData</span><span class="p">(</span> <span class="n">magicNumber</span><span class="p">,</span> <span class="mi">4</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">memcmp</span><span class="p">(</span> <span class="n">magicNumber</span><span class="p">,</span> <span class="n">qskMagicNumber</span><span class="p">,</span> <span class="mi">4</span> <span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qWarning</span><span class="p">(</span> <span class="s">"QskGraphicIO::read: bad magic number"</span> <span class="p">);</span>
        <span class="k">return</span> <span class="n">QskGraphic</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="n">quint32</span> <span class="n">numCommands</span><span class="p">;</span>
    <span class="n">stream</span> <span class="o">&gt;&gt;</span> <span class="n">numCommands</span><span class="p">;</span>

    <span class="n">QVector</span><span class="o">&lt;</span> <span class="n">QskPainterCommand</span> <span class="o">&gt;</span> <span class="n">commands</span><span class="p">;</span>
    <span class="n">commands</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span> <span class="n">numCommands</span> <span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span> <span class="n">uint</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numCommands</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">quint8</span> <span class="n">type</span><span class="p">;</span>
        <span class="n">stream</span> <span class="o">&gt;&gt;</span> <span class="n">type</span><span class="p">;</span>

        <span class="k">switch</span> <span class="p">(</span> <span class="n">type</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Path</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskReadPathData</span><span class="p">(</span> <span class="n">stream</span><span class="p">,</span> <span class="n">commands</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Pixmap</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskReadPixmapData</span><span class="p">(</span> <span class="n">stream</span><span class="p">,</span> <span class="n">commands</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Image</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskReadImageData</span><span class="p">(</span> <span class="n">stream</span><span class="p">,</span> <span class="n">commands</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">State</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskReadStateData</span><span class="p">(</span> <span class="n">stream</span><span class="p">,</span> <span class="n">commands</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nl">default:</span>
                <span class="k">return</span> <span class="n">QskGraphic</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">QskGraphic</span> <span class="n">graphic</span><span class="p">;</span>
    <span class="n">graphic</span><span class="p">.</span><span class="n">setCommands</span><span class="p">(</span> <span class="n">commands</span> <span class="p">);</span>

    <span class="k">return</span> <span class="n">graphic</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">write</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskGraphic</span><span class="o">&amp;</span> <span class="n">graphic</span><span class="p">,</span> <span class="k">const</span> <span class="n">QString</span><span class="o">&amp;</span> <span class="n">fileName</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QFile</span> <span class="n">file</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">file</span><span class="p">.</span><span class="n">open</span><span class="p">(</span> <span class="n">QIODevice</span><span class="o">::</span><span class="n">WriteOnly</span> <span class="o">|</span> <span class="n">QIODevice</span><span class="o">::</span><span class="n">Truncate</span> <span class="p">)</span> <span class="o">==</span> <span class="nb">false</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">qWarning</span><span class="p">(</span> <span class="s">"QskGraphicIO::write can't open %s"</span><span class="p">,</span> <span class="n">qPrintable</span><span class="p">(</span> <span class="n">fileName</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">write</span><span class="p">(</span> <span class="n">graphic</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">file</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">write</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskGraphic</span><span class="o">&amp;</span> <span class="n">graphic</span><span class="p">,</span> <span class="n">QByteArray</span><span class="o">&amp;</span> <span class="n">data</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="n">QBuffer</span> <span class="n">buffer</span><span class="p">(</span> <span class="o">&amp;</span><span class="n">data</span> <span class="p">);</span>
    <span class="k">return</span> <span class="n">write</span><span class="p">(</span> <span class="n">graphic</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buffer</span> <span class="p">);</span>
<span class="p">}</span>

<span class="kt">bool</span> <span class="n">QskGraphicIO</span><span class="o">::</span><span class="n">write</span><span class="p">(</span> <span class="k">const</span> <span class="n">QskGraphic</span><span class="o">&amp;</span> <span class="n">graphic</span><span class="p">,</span> <span class="n">QIODevice</span><span class="o">*</span> <span class="n">dev</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dev</span> <span class="o">==</span> <span class="nb">nullptr</span> <span class="p">)</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

    <span class="n">QDataStream</span> <span class="n">stream</span><span class="p">(</span> <span class="n">dev</span> <span class="p">);</span>
<span class="cp">#if 1
</span>    <span class="n">stream</span><span class="p">.</span><span class="n">setVersion</span><span class="p">(</span> <span class="n">qskDataStreamVersion</span> <span class="p">);</span>
<span class="cp">#endif
</span>    <span class="n">stream</span><span class="p">.</span><span class="n">setByteOrder</span><span class="p">(</span> <span class="n">QDataStream</span><span class="o">::</span><span class="n">BigEndian</span> <span class="p">);</span>
    <span class="n">stream</span><span class="p">.</span><span class="n">writeRawData</span><span class="p">(</span> <span class="n">qskMagicNumber</span><span class="p">,</span> <span class="mi">4</span> <span class="p">);</span>

    <span class="k">const</span> <span class="kt">int</span> <span class="n">numCommands</span> <span class="o">=</span> <span class="n">graphic</span><span class="p">.</span><span class="n">commands</span><span class="p">().</span><span class="n">size</span><span class="p">();</span>
    <span class="k">const</span> <span class="n">QskPainterCommand</span><span class="o">*</span> <span class="n">cmds</span> <span class="o">=</span> <span class="n">graphic</span><span class="p">.</span><span class="n">commands</span><span class="p">().</span><span class="n">constData</span><span class="p">();</span>

    <span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint32</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">numCommands</span> <span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numCommands</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span> <span class="n">quint8</span> <span class="o">&gt;</span><span class="p">(</span> <span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">type</span><span class="p">()</span> <span class="p">);</span>

        <span class="k">switch</span> <span class="p">(</span> <span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">type</span><span class="p">()</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Path</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskWritePathData</span><span class="p">(</span> <span class="o">*</span><span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">path</span><span class="p">(),</span> <span class="n">stream</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Pixmap</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskWritePixmapData</span><span class="p">(</span> <span class="o">*</span><span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">pixmapData</span><span class="p">(),</span> <span class="n">stream</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">Image</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskWriteImageData</span><span class="p">(</span> <span class="o">*</span><span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">imageData</span><span class="p">(),</span> <span class="n">stream</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">case</span> <span class="n">QskPainterCommand</span><span class="o">::</span><span class="n">State</span><span class="p">:</span>
            <span class="p">{</span>
                <span class="n">qskWriteStateData</span><span class="p">(</span> <span class="o">*</span><span class="n">cmds</span><span class="p">[</span> <span class="n">i</span> <span class="p">].</span><span class="n">stateData</span><span class="p">(),</span> <span class="n">stream</span> <span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nl">default:</span>
            <span class="p">{</span>
                <span class="c1">// cleanup ???</span>
                <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<p>Updated on 28 July 2023 at 14:02:30 CEST</p>
